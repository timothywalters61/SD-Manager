<!DOCTYPE html>
<html>

<head>
    <title>Sign Up</title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>

    <script src="https://www.gstatic.com/firebasejs/5.7.0/firebase.js"></script>
    <script>
        var firebaseConfig = {
            apiKey: "AIzaSyB1akwPd-xOMCgU9_Bc6OqdTObTp10Sb5k",
            authDomain: "scrum-manager-91e13.firebaseapp.com",
            databaseURL: "https://scrum-manager-91e13.firebaseio.com",
            projectId: "scrum-manager-91e13",
            storageBucket: "scrum-manager-91e13.appspot.com",
            messagingSenderId: "332929508306",
            appId: "1:332929508306:web:5f1773dc956813db641e0b"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        function signUp() {
            var email = document.getElementById("tfEmailAddress").value;
            var username = document.getElementById("tfUsername").value;
            var password = document.getElementById("tfPassword").value;
            var confirmpassword = document.getElementById("tfConfirmPassword").value;

            if (username.includes(".") || username.includes("#") || username.includes("$") || username.includes("[") || username.includes("]") || username.length === 0) {
                console.log("username cannot contain .#$[] or be empty");
                return 0;
            }

            if(password.length === 0){
                console.log("password cannot be empty");
                return 0;
            }

            if (password === confirmpassword) {
                console.log("passwords match");
                firebase.database().ref('Users/' + username).once("value").then(function (snapshot) {
                    var user = snapshot.val();
                    if (user === null) {
                        firebase.database().ref('Users/' + username).set({
                            email: email,
                            password: password
                        });
                        document.location.href = "login.html";
                    } else {
                        console.log("Username already exists");
                    }
                });
            }
            else {
                console.log("Passwords don't match");
            }
        }

    </script>


    <div class="SignUpBox">
        <!-- <img src="index2.png" class="index"> -->
        <h1>Sign Up Here</h1>
        <form>
            <p>Username</p>
            <input type="text" name="tfUsername" id="tfUsername" placeholder="Enter Username">
            <p>Email Address</p>
            <input type="text" name="tfEmailAddress" id="tfEmailAddress" placeholder="Enter Email Address">
            <p>Password</p>
            <input type="password" name="tfPassword" id="tfPassword" placeholder="Enter Password">
            <p>Confirm Password</p>
            <input type="password" name="tfConfirmPassword" id="tfConfirmPassword" placeholder="Confirm Password">

            <button type="button" onclick="signUp()">Sign Up</button>
            <a href="login.html"> <br><br>Already have an account? Log In</a><br>

        </form>

    </div>
</body>

</html>
